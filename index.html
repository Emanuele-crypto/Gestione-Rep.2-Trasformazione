<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Gestione Produzione Agrumi - Reparto 2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        .header {
            background-color: #D4A017; /* Giallo ocra */
            color: white;
            padding: 15px 0;
            margin-bottom: 30px;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            background-color: #f5efd4;
            font-weight: bold;
        }
        .stats-card {
            text-align: center;
            padding: 15px;
        }
        .stats-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #D4A017;
        }
        .btn-custom {
            background-color: #D4A017;
            color: white;
        }
        .btn-custom:hover {
            background-color: #b08612;
            color: white;
        }
        .required-field::after {
            content: " *";
            color: red;
        }
        /* Aggiungiamo un po' di stile per i pulsanti di registrazione */
        .btn-registro {
            background-color: #0056b3;
            color: white;
            font-weight: bold;
        }
        .btn-registro:hover {
            background-color: #004494;
            color: white;
        }
        .subheader {
            background-color: #f8f5e6;
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 4px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-2 text-start">
                    <button class="btn btn-light" id="btn-reparto-1">
                        <i class="bi bi-arrow-left-circle"></i> Reparto 1
                    </button>
                </div>
                <div class="col-md-8 text-center">
                    <h1>SIMONE GATTO PROD-REPARTO 2- TRASFORMAZIONE</h1>
                </div>
                <div class="col-md-2 text-end">
                    <button class="btn btn-light" id="btn-reparto-3">
                        Reparto 3 <i class="bi bi-arrow-right-circle"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mb-5">
        <!-- Statistiche -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="stats-value" id="total-lotti">0</div>
                    <div>Lotti in Lavorazione</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="stats-value" id="total-succo">0 L</div>
                    <div>Succo Totale</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="stats-value" id="total-olio">0 L</div>
                    <div>Olio Essenziale</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card stats-card">
                    <div class="stats-value" id="lotti-registrati">0</div>
                    <div>Lotti Registrati</div>
                </div>
            </div>
        </div>

        <!-- Form inserimento dati -->
        <div class="card mb-4">
            <div class="card-header">
                <i class="bi bi-pencil-square"></i> Inserimento Dati di Lavorazione
            </div>
            <div class="card-body">
                <form id="produzione-form">
                    <!-- Nuova sezione per orari e quantità -->
                    <div class="row mb-4">
                        <div class="subheader col-12 mb-3">Orari e Quantità</div>
                        
                        <div class="col-md-3">
                            <label for="orario-partenza-stimata" class="form-label">Orario di Partenza Stimata</label>
                            <input type="time" class="form-control" id="orario-partenza-stimata">
                        </div>
                        <div class="col-md-3">
                            <label for="orario-partenza-effettivo" class="form-label">Orario di Partenza Effettivo</label>
                            <input type="time" class="form-control" id="orario-partenza-effettivo">
                            <small class="text-muted">Rilevato da Rep. 1</small>
                        </div>
                        <div class="col-md-3">
                            <label for="orario-fine-stimato" class="form-label">Orario di Fine Stimato</label>
                            <input type="time" class="form-control" id="orario-fine-stimato">
                        </div>
                        <div class="col-md-3">
                            <label for="orario-fine-effettivo" class="form-label">Orario di Fine Effettivo</label>
                            <input type="time" class="form-control" id="orario-fine-effettivo">
                            <small class="text-muted">Rilevato da Rep. 1</small>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <label for="quantita-frutta-stimata" class="form-label">Quantità Frutta Stimata (kg)</label>
                            <input type="number" class="form-control" id="quantita-frutta-stimata" min="0">
                        </div>
                        <div class="col-md-6">
                            <label for="quantita-frutta-effettiva" class="form-label">Quantità Frutta Effettiva (kg)</label>
                            <input type="number" class="form-control" id="quantita-frutta-effettiva" min="0">
                            <small class="text-muted">Rilevato da Rep. 1 (Totale frutta nei silos per lotti)</small>
                        </div>
                    </div>
                    
                    <div class="subheader col-12 mb-3">Dettagli Lavorazione</div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="linea-trasformazione" class="form-label required-field">Linea di Trasformazione</label>
                            <select class="form-select" id="linea-trasformazione" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="BOE">BOE</option>
                                <option value="GOE INT">GOE INT</option>
                                <option value="B/SF">B/SF</option>
                                <option value="400">400</option>
                                <option value="ALTRA">ALTRA</option>
                            </select>
                            <div id="altra-linea-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altra-linea" placeholder="Specifica altra linea">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="fornitore" class="form-label required-field">Fornitore</label>
                            <select class="form-select" id="fornitore" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="ARCO">ARCO</option>
                                <option value="CI">CI</option>
                                <option value="RESTUCCIA">RESTUCCIA</option>
                                <option value="ALTRO">ALTRO</option>
                            </select>
                            <div id="altro-fornitore-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altro-fornitore" placeholder="Specifica altro fornitore">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="tipo-agrume" class="form-label required-field">Tipo Agrume</label>
                            <select class="form-select" id="tipo-agrume" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="Arance">Arance</option>
                                <option value="Arance Rosse">Arance Rosse</option>
                                <option value="Limoni">Limoni</option>
                                <option value="Mandarini">Mandarini</option>
                                <option value="Pompelmi">Pompelmi</option>
                                <option value="Altro">Altro</option>
                            </select>
                            <div id="altro-agrume-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altro-agrume" placeholder="Specifica altro agrume">
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="destinazione-essenza" class="form-label required-field">Destinazione Essenza</label>
                            <select class="form-select" id="destinazione-essenza" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="Bio">Bio</option>
                                <option value="Convenzionale">Convenzionale</option>
                                <option value="Non Trattato">Non Trattato</option>
                                <option value="Altra">Altra</option>
                            </select>
                            <div id="altra-essenza-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altra-essenza" placeholder="Specifica altra destinazione">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="certificazione" class="form-label required-field">Certificazione</label>
                            <select class="form-select" id="certificazione" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="BIO EU">BIO EU</option>
                                <option value="BIO DEMETER">BIO DEMETER</option>
                                <option value="CONVENZIONALE">CONVENZIONALE</option>
                                <option value="IGP">IGP</option>
                                <option value="ALTRO">ALTRO</option>
                            </select>
                            <div id="altra-certificazione-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altra-certificazione" placeholder="Specifica altra certificazione">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="quantita" class="form-label required-field">Quantità (kg)</label>
                            <input type="number" class="form-control" id="quantita" required min="1">
                        </div>
                    </div>

                    <h5 class="mt-4 mb-3 border-bottom pb-2">Destinazione Spremiture</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <label for="tipo-prodotto-prima" class="form-label">1ª Spremitura</label>
                            <select class="form-select mb-3" id="tipo-prodotto-prima">
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="PRODOTTO SEMILAVORATO">PRODOTTO SEMILAVORATO</option>
                                <option value="PRODOTTO FINITO">PRODOTTO FINITO</option>
                            </select>
                            
                            <div id="opzioni-prima-container" style="display: none;">
                                <label for="grado-bx-prima" class="form-label">Grado °BX</label>
                                <select class="form-select mb-2" id="grado-bx-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="NAT">NAT</option>
                                    <option value="20°">20°</option>
                                    <option value="32°">32°</option>
                                    <option value="40°">40°</option>
                                    <option value="45°">45°</option>
                                    <option value="55°">55°</option>
                                    <option value="58°">58°</option>
                                    <option value="60°">60°</option>
                                    <option value="63,5°">63,5°</option>
                                    <option value="65°">65°</option>
                                </select>
                                
                                <label for="tenore-polpa-prima" class="form-label">Tenore di Polpa</label>
                                <select class="form-select mb-2" id="tenore-polpa-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="LIMPIDO">LIMPIDO</option>
                                    <option value="SEMICLEAR">SEMICLEAR</option>
                                    <option value="1%">1%</option>
                                    <option value="2%">2%</option>
                                    <option value="3%">3%</option>
                                    <option value="5%">5%</option>
                                    <option value="STANDARD">STANDARD</option>
                                </select>
                                
                                <label for="stoccaggio-prima" class="form-label">Stoccaggio/Confezionamento</label>
                                <select class="form-select mb-2" id="stoccaggio-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="PET 100">PET 100</option>
                                    <option value="PET 200">PET 200</option>
                                    <option value="PET 480">PET 480</option>
                                    <option value="REX">REX</option>
                                    <option value="ACMA">ACMA</option>
                                    <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                    <option value="VASCHETTE">VASCHETTE</option>
                                    <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                    <option value="LATTE">LATTE</option>
                                    <option value="FBL">FBL</option>
                                    <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                    <option value="FUSTI T.C">FUSTI T.C</option>
                                    <option value="BIC">BIC</option>
                                    <option value="SERB 1 AZZ">SERB 1 AZZ</option>
                                    <option value="SERB 2 AZZ">SERB 2 AZZ</option>
                                    <option value="SERB 3 AZZ">SERB 3 AZZ</option>
                                    <option value="SERB 4 AZZ">SERB 4 AZZ</option>
                                    <option value="SERB 5 AZZ">SERB 5 AZZ</option>
                                    <option value="SERB 6 AZZ">SERB 6 AZZ</option>
                                    <option value="SERB 7 AZZ">SERB 7 AZZ</option>
                                    <option value="SERB 8 AZZ">SERB 8 AZZ</option>
                                    <option value="SERB 9 AZZ">SERB 9 AZZ</option>
                                    <option value="SERB 10 AZZ">SERB 10 AZZ</option>
                                    <option value="SERB 1 EST">SERB 1 EST</option>
                                    <option value="SERB 2 EST">SERB 2 EST</option>
                                    <option value="SERB 3 EST">SERB 3 EST</option>
                                    <option value="SERB 4 EST">SERB 4 EST</option>
                                    <option value="SERB 5 EST">SERB 5 EST</option>
                                    <option value="SERB 6 EST">SERB 6 EST</option>
                                    <option value="SERB 7 EST">SERB 7 EST</option>
                                    <option value="SERB 8 EST">SERB 8 EST</option>
                                    <option value="SERB 9 EST">SERB 9 EST</option>
                                    <option value="SERB 10 EST">SERB 10 EST</option>
                                    <option value="SERB 11 EST">SERB 11 EST</option>
                                    <option value="SERB 12 EST">SERB 12 EST</option>
                                    <option value="SERB 13 EST">SERB 13 EST</option>
                                    <option value="SERB 14 EST">SERB 14 EST</option>
                                    <option value="SERB 15 EST">SERB 15 EST</option>
                                    <option value="SERB 16 EST">SERB 16 EST</option>
                                    <option value="SERB 17 EST">SERB 17 EST</option>
                                    <option value="SERB 18 EST">SERB 18 EST</option>
                                    <option value="SERB 71 EST">SERB 71 EST</option>
                                    <option value="SERB 72 EST">SERB 72 EST</option>
                                    <option value="SERB 73 EST">SERB 73 EST</option>
                                    <option value="SERB 74 EST">SERB 74 EST</option>
                                    <option value="SERB 75 EST">SERB 75 EST</option>
                                    <option value="SERB 76 EST">SERB 76 EST</option>
                                    <option value="SERB 77 EST">SERB 77 EST</option>
                                    <option value="SERB 78 EST">SERB 78 EST</option>
                                    <option value="SERB 79 EST">SERB 79 EST</option>
                                    <option value="SERB 80 EST">SERB 80 EST</option>
                                    <option value="SERB 81 EST">SERB 81 EST</option>
                                </select>
                                
                                <label for="quantita-prima" class="form-label">Quantità (L)</label>
                                <input type="number" class="form-control mb-2" id="quantita-prima" min="0">
                            </div>
                            
                            <div class="mt-2">
                                <label for="note-prima" class="form-label">Note</label>
                                <textarea class="form-control" id="note-prima" rows="2"></textarea>
                            </div>
                        </div>
                        
                        <div class="col-md-3">
                            <label for="tipo-prodotto-seconda" class="form-label">2ª Spremitura</label>
                            <select class="form-select mb-3" id="tipo-prodotto-seconda">
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="PRODOTTO SEMILAVORATO">PRODOTTO SEMILAVORATO</option>
                                <option value="PRODOTTO FINITO">PRODOTTO FINITO</option>
                            </select>
                            
                            <div id="opzioni-seconda-container" style="display: none;">
                                <label for="grado-bx-seconda" class="form-label">Grado °BX</label>
                                <select class="form-select mb-2" id="grado-bx-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="NAT">NAT</option>
                                    <option value="20°">20°</option>
                                    <option value="32°">32°</option>
                                    <option value="40°">40°</option>
                                    <option value="45°">45°</option>
                                    <option value="55°">55°</option>
                                    <option value="58°">58°</option>
                                    <option value="60°">60°</option>
                                    <option value="63,5°">63,5°</option>
                                    <option value="65°">65°</option>
                                </select>
                                
                                <label for="tenore-polpa-seconda" class="form-label">Tenore di Polpa</label>
                                <select class="form-select mb-2" id="tenore-polpa-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="LIMPIDO">LIMPIDO</option>
                                    <option value="SEMICLEAR">SEMICLEAR</option>
                                    <option value="1%">1%</option>
                                    <option value="2%">2%</option>
                                    <option value="3%">3%</option>
                                    <option value="5%">5%</option>
                                    <option value="STANDARD">STANDARD</option>
                                </select>
                                
                                <label for="stoccaggio-seconda" class="form-label">Stoccaggio/Confezionamento</label>
                                <select class="form-select mb-2" id="stoccaggio-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="PET 100">PET 100</option>
                                    <option value="PET 200">PET 200</option>
                                    <option value="PET 480">PET 480</option>
                                    <option value="REX">REX</option>
                                    <option value="ACMA">ACMA</option>
                                    <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                    <option value="VASCHETTE">VASCHETTE</option>
                                    <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                    <option value="LATTE">LATTE</option>
                                    <option value="FBL">FBL</option>
                                    <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                    <option value="FUSTI T.C">FUSTI T.C</option>
                                    <option value="BIC">BIC</option>
                                    <option value="SERB 1 AZZ">SERB 1 AZZ</option>
                                    <option value="SERB 2 AZZ">SERB 2 AZZ</option>
                                    <option value="SERB 3 AZZ">SERB 3 AZZ</option>
                                    <option value="SERB 4 AZZ">SERB 4 AZZ</option>
                                    <option value="SERB 5 AZZ">SERB 5 AZZ</option>
                                    <option value="SERB 6 AZZ">SERB 6 AZZ</option>
                                    <option value="SERB 7 AZZ">SERB 7 AZZ</option>
                                    <option value="SERB 8 AZZ">SERB 8 AZZ</option>
                                    <option value="SERB 9 AZZ">SERB 9 AZZ</option>
                                    <option value="SERB 10 AZZ">SERB 10 AZZ</option>
                                    <option value="SERB 1 EST">SERB 1 EST</option>
                                    <option value="SERB 2 EST">SERB 2 EST</option>
                                    <option value="SERB 3 EST">SERB 3 EST</option>
                                    <option value="SERB 4 EST">SERB 4 EST</option>
                                    <option value="SERB 5 EST">SERB 5 EST</option>
                                    <option value="SERB 6 EST">SERB 6 EST</option>
                                    <option value="SERB 7 EST">SERB 7 EST</option>
                                    <option value="SERB 8 EST">SERB 8 EST</option>
                                    <option value="SERB 9 EST">SERB 9 EST</option>
                                    <option value="SERB 10 EST">SERB 10 EST</option>
                                    <option value="SERB 11 EST">SERB 11 EST</option>
                                    <option value="SERB 12 EST">SERB 12 EST</option>
                                    <option value="SERB 13 EST">SERB 13 EST</option>
                                    <option value="SERB 14 EST">SERB 14 EST</option>
                                    <option value="SERB 15 EST">SERB 15 EST</option>
                                    <option value="SERB 16 EST">SERB 16 EST</option>
                                    <option value="SERB 17 EST">SERB 17 EST</option>
                                    <option value="SERB 18 EST">SERB 18 EST</option>
                                    <option value="SERB 71 EST">SERB 71 EST</option>
                                    <option value="SERB 72 EST">SERB 72 EST</option>
                                    <option value="SERB 73 EST">SERB 73 EST</option>
                                    <option value="SERB 74 EST">SERB 74 EST</option>
                                    <option value="SERB 75 EST">SERB 75 EST</option>
                                    <option value="SERB 76 EST">SERB 76 EST</option>
                                    <option value="SERB 77 EST">SERB 77 EST</option>
                                    <option value="SERB 78 EST">SERB 78 EST</option>
                                    <option value="SERB 79 EST">SERB 79 EST</option>
                                    <option value="SERB 80 EST">SERB 80 EST</option>
                                    <option value="SERB 81 EST">SERB 81 EST</option>
                                </select>
                                
                                <label for="quantita-seconda" class="form-label">Quantità (L)</label>
                                <input type="number" class="form-control mb-2" id="quantita-seconda" min="0">
                            </div>
                            
                            <div class="mt-2">
                                <label for="note-seconda" class="form-label">Note</label>
                                <textarea class="form-control" id="note-seconda" rows="2"></textarea>
                            </div>
                        </div>
                        
                        <div class="col-md-3">
                            <label for="tipo-prodotto-torchiato" class="form-label">Torchiato</label>
                            <select class="form-select mb-3" id="tipo-prodotto-torchiato">
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="PRODOTTO SEMILAVORATO">PRODOTTO SEMILAVORATO</option>
                                <option value="PRODOTTO FINITO">PRODOTTO FINITO</option>
                            </select>
                            
                            <div id="opzioni-torchiato-container" style="display: none;">
                                <label for="grado-bx-torchiato" class="form-label">Grado °BX</label>
                                <select class="form-select mb-2" id="grado-bx-torchiato">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="NAT">NAT</option>
                                    <option value="20°">20°</option>
                                    <option value="32°">32°</option>
                                    <option value="40°">40°</option>
                                    <option value="45°">45°</option>
                                    <option value="55°">55°</option>
                                    <option value="58°">58°</option>
                                    <option value="60°">60°</option>
                                    <option value="63,5°">63,5°</option>
                                    <option value="65°">65°</option>
                                </select>
                                
                                <label for="tenore-polpa-torchiato" class="form-label">Tenore di Polpa</label>
                                <select class="form-select mb-2" id="tenore-polpa-torchiato">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="LIMPIDO">LIMPIDO</option>
                                    <option value="SEMICLEAR">SEMICLEAR</option>
                                    <option value="1%">1%</option>
                                    <option value="2%">2%</option>
                                    <option value="3%">3%</option>
                                   <option value="5%">5%</option>
                                   <option value="STANDARD">STANDARD</option>
                               </select>
                               
                               <label for="stoccaggio-torchiato" class="form-label">Stoccaggio/Confezionamento</label>
                               <select class="form-select mb-2" id="stoccaggio-torchiato">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="PET 100">PET 100</option>
                                   <option value="PET 200">PET 200</option>
                                   <option value="PET 480">PET 480</option>
                                   <option value="REX">REX</option>
                                   <option value="ACMA">ACMA</option>
                                   <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                   <option value="VASCHETTE">VASCHETTE</option>
                                   <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                   <option value="LATTE">LATTE</option>
                                   <option value="FBL">FBL</option>
                                   <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                   <option value="FUSTI T.C">FUSTI T.C</option>
                                   <option value="BIC">BIC</option>
                                   <option value="SERB 1 AZZ">SERB 1 AZZ</option>
                                   <option value="SERB 2 AZZ">SERB 2 AZZ</option>
                                   <option value="SERB 3 AZZ">SERB 3 AZZ</option>
                                   <option value="SERB 4 AZZ">SERB 4 AZZ</option>
                                   <option value="SERB 5 AZZ">SERB 5 AZZ</option>
                                   <option value="SERB 6 AZZ">SERB 6 AZZ</option>
                                   <option value="SERB 7 AZZ">SERB 7 AZZ</option>
                                   <option value="SERB 8 AZZ">SERB 8 AZZ</option>
                                   <option value="SERB 9 AZZ">SERB 9 AZZ</option>
                                   <option value="SERB 10 AZZ">SERB 10 AZZ</option>
                                   <option value="SERB 1 EST">SERB 1 EST</option>
                                   <option value="SERB 2 EST">SERB 2 EST</option>
                                   <option value="SERB 3 EST">SERB 3 EST</option>
                                   <option value="SERB 4 EST">SERB 4 EST</option>
                                   <option value="SERB 5 EST">SERB 5 EST</option>
                                   <option value="SERB 6 EST">SERB 6 EST</option>
                                   <option value="SERB 7 EST">SERB 7 EST</option>
                                   <option value="SERB 8 EST">SERB 8 EST</option>
                                   <option value="SERB 9 EST">SERB 9 EST</option>
                                   <option value="SERB 10 EST">SERB 10 EST</option>
                                   <option value="SERB 11 EST">SERB 11 EST</option>
                                   <option value="SERB 12 EST">SERB 12 EST</option>
                                   <option value="SERB 13 EST">SERB 13 EST</option>
                                   <option value="SERB 14 EST">SERB 14 EST</option>
                                   <option value="SERB 15 EST">SERB 15 EST</option>
                                   <option value="SERB 16 EST">SERB 16 EST</option>
                                   <option value="SERB 17 EST">SERB 17 EST</option>
                                   <option value="SERB 18 EST">SERB 18 EST</option>
                                   <option value="SERB 71 EST">SERB 71 EST</option>
                                   <option value="SERB 72 EST">SERB 72 EST</option>
                                   <option value="SERB 73 EST">SERB 73 EST</option>
                                   <option value="SERB 74 EST">SERB 74 EST</option>
                                   <option value="SERB 75 EST">SERB 75 EST</option>
                                   <option value="SERB 76 EST">SERB 76 EST</option>
                                   <option value="SERB 77 EST">SERB 77 EST</option>
                                   <option value="SERB 78 EST">SERB 78 EST</option>
                                   <option value="SERB 79 EST">SERB 79 EST</option>
                                   <option value="SERB 80 EST">SERB 80 EST</option>
                                   <option value="SERB 81 EST">SERB 81 EST</option>
                               </select>
                               
                               <label for="quantita-torchiato" class="form-label">Quantità (L)</label>
                               <input type="number" class="form-control mb-2" id="quantita-torchiato" min="0">
                           </div>
                           
                           <div class="mt-2">
                               <label for="note-torchiato" class="form-label">Note</label>
                               <textarea class="form-control" id="note-torchiato" rows="2"></textarea>
                           </div>
                       </div>
                       
                       <div class="col-md-3">
                           <label for="tipo-prodotto-estratto" class="form-label">Estratto</label>
                           <select class="form-select mb-3" id="tipo-prodotto-estratto">
                               <option value="" selected disabled>Seleziona...</option>
                               <option value="PRODOTTO SEMILAVORATO">PRODOTTO SEMILAVORATO</option>
                               <option value="PRODOTTO FINITO">PRODOTTO FINITO</option>
                           </select>
                           
                           <div id="opzioni-estratto-container" style="display: none;">
                               <label for="grado-bx-estratto" class="form-label">Grado °BX</label>
                               <select class="form-select mb-2" id="grado-bx-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="NAT">NAT</option>
                                   <option value="20°">20°</option>
                                   <option value="32°">32°</option>
                                   <option value="40°">40°</option>
                                   <option value="45°">45°</option>
                                   <option value="55°">55°</option>
                                   <option value="58°">58°</option>
                                   <option value="60°">60°</option>
                                   <option value="63,5°">63,5°</option>
                                   <option value="65°">65°</option>
                               </select>
                               
                               <label for="tenore-polpa-estratto" class="form-label">Tenore di Polpa</label>
                               <select class="form-select mb-2" id="tenore-polpa-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="LIMPIDO">LIMPIDO</option>
                                   <option value="SEMICLEAR">SEMICLEAR</option>
                                   <option value="1%">1%</option>
                                   <option value="2%">2%</option>
                                   <option value="3%">3%</option>
                                   <option value="5%">5%</option>
                                   <option value="STANDARD">STANDARD</option>
                               </select>
                               
                               <label for="stoccaggio-estratto" class="form-label">Stoccaggio/Confezionamento</label>
                               <select class="form-select mb-2" id="stoccaggio-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="PET 100">PET 100</option>
                                   <option value="PET 200">PET 200</option>
                                   <option value="PET 480">PET 480</option>
                                   <option value="REX">REX</option>
                                   <option value="ACMA">ACMA</option>
                                   <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                   <option value="VASCHETTE">VASCHETTE</option>
                                   <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                   <option value="LATTE">LATTE</option>
                                   <option value="FBL">FBL</option>
                                   <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                   <option value="FUSTI T.C">FUSTI T.C</option>
                                   <option value="BIC">BIC</option>
                                   <option value="SERB 1 AZZ">SERB 1 AZZ</option>
                                   <option value="SERB 2 AZZ">SERB 2 AZZ</option>
                                   <option value="SERB 3 AZZ">SERB 3 AZZ</option>
                                   <option value="SERB 4 AZZ">SERB 4 AZZ</option>
                                   <option value="SERB 5 AZZ">SERB 5 AZZ</option>
                                   <option value="SERB 6 AZZ">SERB 6 AZZ</option>
                                   <option value="SERB 7 AZZ">SERB 7 AZZ</option>
                                   <option value="SERB 8 AZZ">SERB 8 AZZ</option>
                                   <option value="SERB 9 AZZ">SERB 9 AZZ</option>
                                   <option value="SERB 10 AZZ">SERB 10 AZZ</option>
                                   <option value="SERB 1 EST">SERB 1 EST</option>
                                   <option value="SERB 2 EST">SERB 2 EST</option>
                                   <option value="SERB 3 EST">SERB 3 EST</option>
                                   <option value="SERB 4 EST">SERB 4 EST</option>
                                   <option value="SERB 5 EST">SERB 5 EST</option>
                                   <option value="SERB 6 EST">SERB 6 EST</option>
                                   <option value="SERB 7 EST">SERB 7 EST</option>
                                   <option value="SERB 8 EST">SERB 8 EST</option>
                                   <option value="SERB 9 EST">SERB 9 EST</option>
                                   <option value="SERB 10 EST">SERB 10 EST</option>
                                   <option value="SERB 11 EST">SERB 11 EST</option>
                                   <option value="SERB 12 EST">SERB 12 EST</option>
                                   <option value="SERB 13 EST">SERB 13 EST</option>
                                   <option value="SERB 14 EST">SERB 14 EST</option>
                                   <option value="SERB 15 EST">SERB 15 EST</option>
                                   <option value="SERB 16 EST">SERB 16 EST</option>
                                   <option value="SERB 17 EST">SERB 17 EST</option>
                                   <option value="SERB 18 EST">SERB 18 EST</option>
                                   <option value="SERB 71 EST">SERB 71 EST</option>
                                   <option value="SERB 72 EST">SERB 72 EST</option>
                                   <option value="SERB 73 EST">SERB 73 EST</option>
                                   <option value="SERB 74 EST">SERB 74 EST</option>
                                   <option value="SERB 75 EST">SERB 75 EST</option>
                                   <option value="SERB 76 EST">SERB 76 EST</option>
                                   <option value="SERB 77 EST">SERB 77 EST</option>
                                   <option value="SERB 78 EST">SERB 78 EST</option>
                                   <option value="SERB 79 EST">SERB 79 EST</option>
                                   <option value="SERB 80 EST">SERB 80 EST</option>
                                   <option value="SERB 81 EST">SERB 81 EST</option>
                               </select>
                               
                               <label for="quantita-estratto" class="form-label">Quantità (L)</label>
                               <input type="number" class="form-control mb-2" id="quantita-estratto" min="0">
                           </div>
                           
                           <div class="mt-2">
                               <label for="note-estratto" class="form-label">Note</label>
                               <textarea class="form-control" id="note-estratto" rows="2"></textarea>
                           </div>
                       </div>
                   </div>

                   <div class="text-end mt-4">
                       <button type="button" class="btn btn-secondary me-2" id="btn-reset">
                           <i class="bi bi-x-circle"></i> Annulla
                       </button>
                       <button type="submit" class="btn btn-custom me-2">
                           <i class="bi bi-save"></i> Salva Dati
                       </button>
                       <button type="button" class="btn btn-registro" id="btn-registro-elettronico">
                           <i class="bi bi-journal-check"></i> Registra su Bolletta Elettronica
                       </button>
                   </div>
               </form>
           </div>
       </div>
   </div>

   <!-- Script JS -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
   <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
   <script>
       $(document).ready(function() {
           // Dati di stato
           let lottiCount = 0;
           let succoTotale = 0;
           let olioTotale = 0;
           let lottiRegistrati = 0;
           
           // Gestione altra linea di trasformazione
           $("#linea-trasformazione").change(function() {
               if ($(this).val() === "ALTRA") {
                   $("#altra-linea-container").show();
               } else {
                   $("#altra-linea-container").hide();
                   $("#altra-linea").val("");
               }
           });
           
           // Gestione altro fornitore
           $("#fornitore").change(function() {
               if ($(this).val() === "ALTRO") {
                   $("#altro-fornitore-container").show();
               } else {
                   $("#altro-fornitore-container").hide();
                   $("#altro-fornitore").val("");
               }
           });
           
           // Gestione altro agrume
           $("#tipo-agrume").change(function() {
               if ($(this).val() === "Altro") {
                   $("#altro-agrume-container").show();
               } else {
                   $("#altro-agrume-container").hide();
                   $("#altro-agrume").val("");
               }
           });
           
           // Gestione altra destinazione essenza
           $("#destinazione-essenza").change(function() {
               if ($(this).val() === "Altra") {
                   $("#altra-essenza-container").show();
               } else {
                   $("#altra-essenza-container").hide();
                   $("#altra-essenza").val("");
               }
           });
           
           // Gestione altra certificazione
           $("#certificazione").change(function() {
               if ($(this).val() === "ALTRO") {
                   $("#altra-certificazione-container").show();
               } else {
                   $("#altra-certificazione-container").hide();
                   $("#altra-certificazione").val("");
               }
           });
           
           // IMPORTANTE: Gestione per visualizzare/nascondere i campi aggiuntivi per ciascun tipo di prodotto
           // Prima spremitura
           $("#tipo-prodotto-prima").on("change", function() {
               if ($(this).val()) {
                   $("#opzioni-prima-container").slideDown();
               } else {
                   $("#opzioni-prima-container").slideUp();
               }
           });
           
           // Seconda spremitura
           $("#tipo-prodotto-seconda").on("change", function() {
               if ($(this).val()) {
                   $("#opzioni-seconda-container").slideDown();
               } else {
                   $("#opzioni-seconda-container").slideUp();
               }
           });
           
           // Torchiato
           $("#tipo-prodotto-torchiato").on("change", function() {
               if ($(this).val()) {
                   $("#opzioni-torchiato-container").slideDown();
               } else {
                   $("#opzioni-torchiato-container").slideUp();
               }
           });
           
           // Estratto
           $("#tipo-prodotto-estratto").on("change", function() {
               if ($(this).val()) {
                   $("#opzioni-estratto-container").slideDown();
               } else {
                   $("#opzioni-estratto-container").slideUp();
               }
           });
           
           // Pulsante reset form
           $("#btn-reset").click(function() {
               if (confirm("Vuoi davvero annullare? I dati inseriti andranno persi.")) {
                   $("#produzione-form")[0].reset();
                   $("[id^='opzioni-']").hide();
                   $("[id$='-container']").hide();
               }
           });
           
           // Pulsanti navigazione reparti
           $("#btn-reparto-1").click(function() {
               if (confirm("Passare al Reparto 1? Le modifiche non salvate andranno perse.")) {
                   alert("Collegamento al Reparto 1 simulato.");
               }
           });
           
           $("#btn-reparto-3").click(function() {
               if (confirm("Passare al Reparto 3? Le modifiche non salvate andranno perse.")) {
                   alert("Collegamento al Reparto 3 simulato.");
               }
           });
           
           // Pulsante registro elettronico
           $("#btn-registro-elettronico").click(function() {
               // Verifica se ci sono dati da registrare
               if (lottiCount === 0) {
                   alert("Non ci sono lotti da registrare nella bolletta elettronica.");
                   return;
               }
               
               // Simulazione registrazione
               let numeroRegistrazione = "REG-" + new Date().getTime().toString().substr(-6);
               lottiRegistrati++;
               
               // Aggiornamento contatore
               $("#lotti-registrati").text(lottiRegistrati);
               
               alert("Registrazione su bolletta elettronica completata con successo!\nNumero registrazione: " + numeroRegistrazione);
           });
           
           // Salvataggio dati produzione
           $("#produzione-form").submit(function(e) {
               e.preventDefault();
               
               // Validazione dati
               let isValid = true;
               let errorMessage = "";
               
               // Validazione campi obbligatori base
               if (!$("#linea-trasformazione").val() || !$("#fornitore").val() || 
                   !$("#tipo-agrume").val() || !$("#destinazione-essenza").val() || 
                   !$("#certificazione").val() || !$("#quantita").val()) {
                   errorMessage += "- Completa tutti i campi obbligatori nella sezione Dettagli Lavorazione\n";
                   isValid = false;
               }
               
               // Validazione dati spremitura
               let hasSpremitura = false;
               
               // Prima spremitura
               if ($("#tipo-prodotto-prima").val()) {
                   hasSpremitura = true;
                   
                   if (!$("#grado-bx-prima").val() || 
                       !$("#tenore-polpa-prima").val() || 
                       !$("#stoccaggio-prima").val() ||
                       !$("#quantita-prima").val() || $("#quantita-prima").val() <= 0) {
                       errorMessage += "- Completa tutti i campi per la 1ª Spremitura\n";
                       isValid = false;
                   }
               }
               
               // Seconda spremitura
               if ($("#tipo-prodotto-seconda").val()) {
                   hasSpremitura = true;
                   
                   if (!$("#grado-bx-seconda").val() || 
                       !$("#tenore-polpa-seconda").val() || 
                       !$("#stoccaggio-seconda").val() ||
                       !$("#quantita-seconda").val() || $("#quantita-seconda").val() <= 0) {
                       errorMessage += "- Completa tutti i campi per la 2ª Spremitura\n";
                       isValid = false;
                   }
               }
               
               // Torchiato
               if ($("#tipo-prodotto-torchiato").val()) {
                   hasSpremitura = true;
                   
                   if (!$("#grado-bx-torchiato").val() || 
                       !$("#tenore-polpa-torchiato").val() || 
                       !$("#stoccaggio-torchiato").val() ||
                       !$("#quantita-torchiato").val() || $("#quantita-torchiato").val() <= 0) {
                       errorMessage += "- Completa tutti i campi per il Torchiato\n";
                       isValid = false;
                   }
               }
               
               // Estratto
               if ($("#tipo-prodotto-estratto").val()) {
                   hasSpremitura = true;
                   
                   if (!$("#grado-bx-estratto").val() || 
                       !$("#tenore-polpa-estratto").val() || 
                       !$("#stoccaggio-estratto").val() ||
                       !$("#quantita-estratto").val() || $("#quantita-estratto").val() <= 0) {
                       errorMessage += "- Completa tutti i campi per l'Estratto\n";
                       isValid = false;
                   }
               }
               
               // Verifica che ci sia almeno una spremitura
               if (!hasSpremitura) {
                   errorMessage += "- Seleziona almeno un tipo di spremitura\n";
                   isValid = false;
               }
               
               // Mostra errori se presenti
               if (!isValid) {
                   alert("Si sono verificati i seguenti errori:\n" + errorMessage);
                   return;
               }
               
               // Raccolta dati produzione
               let datiProduzione = {
                   // Orari e quantità
                   orarioPartenzaStimata: $("#orario-partenza-stimata").val(),
                   orarioPartenzaEffettivo: $("#orario-partenza-effettivo").val(),
                   orarioFineStimato: $("#orario-fine-stimato").val(),
                   orarioFineEffettivo: $("#orario-fine-effettivo").val(),
                   quantitaFruttaStimata: $("#quantita-frutta-stimata").val(),
                   quantitaFruttaEffettiva: $("#quantita-frutta-effettiva").val(),
                   
                   // Dettagli lavorazione
                   lineaTrasformazione: $("#linea-trasformazione").val() === "ALTRA" ? $("#altra-linea").val() : $("#linea-trasformazione").val(),
                   fornitore: $("#fornitore").val() === "ALTRO" ? $("#altro-fornitore").val() : $("#fornitore").val(),
                   tipoAgrume: $("#tipo-agrume").val() === "Altro" ? $("#altro-agrume").val() : $("#tipo-agrume").val(),
                   destinazioneEssenza: $("#destinazione-essenza").val() === "Altra" ? $("#altra-essenza").val() : $("#destinazione-essenza").val(),
                   certificazione: $("#certificazione").val() === "ALTRO" ? $("#altra-certificazione").val() : $("#certificazione").val(),
                   quantita: parseInt($("#quantita").val()),
                   
                   // Spremiture
                   spremiture: {
                       prima: {
                           tipoProdotto: $("#tipo-prodotto-prima").val(),
                           gradoBx: $("#grado-bx-prima").val(),
                           tenorePolpa: $("#tenore-polpa-prima").val(),
                           stoccaggio: $("#stoccaggio-prima").val(),
                           quantita: parseInt($("#quantita-prima").val()) || 0,
                           note: $("#note-prima").val()
                       },
                       seconda: {
                           tipoProdotto: $("#tipo-prodotto-seconda").val(),
                           gradoBx: $("#grado-bx-seconda").val(),
                           tenorePolpa: $("#tenore-polpa-seconda").val(),
                           stoccaggio: $("#stoccaggio-seconda").val(),
                           quantita: parseInt($("#quantita-seconda").val()) || 0,
                           note: $("#note-seconda").val()
                       },
                       torchiato: {
                           tipoProdotto: $("#tipo-prodotto-torchiato").val(),
                           gradoBx: $("#grado-bx-torchiato").val(),
                           tenorePolpa: $("#tenore-polpa-torchiato").val(),
                           stoccaggio: $("#stoccaggio-torchiato").val(),
                           quantita: parseInt($("#quantita-torchiato").val()) || 0,
                           note: $("#note-torchiato").val()
                       },
                       estratto: {
                           tipoProdotto: $("#tipo-prodotto-estratto").val(),
                           gradoBx: $("#grado-bx-estratto").val(),
                           tenorePolpa: $("#tenore-polpa-estratto").val(),
                           stoccaggio: $("#stoccaggio-estratto").val(),
                           quantita: parseInt($("#quantita-estratto").val()) || 0,
                           note: $("#note-estratto").val()
                       }
                   }
               };
               
               // Simulazione generazione ID lotto
               const now = new Date();
               const lottoId = "L-" + 
                              now.getFullYear() + 
                              padZero(now.getMonth() + 1) + 
                              padZero(now.getDate()) + "-" + 
                              padZero(now.getHours()) + 
                              padZero(now.getMinutes());
               
               // Calcolo totali
               let quantitaTotaleSucco = 0;
               if (datiProduzione.spremiture.prima.quantita) quantitaTotaleSucco += datiProduzione.spremiture.prima.quantita;
               if (datiProduzione.spremiture.seconda.quantita) quantitaTotaleSucco += datiProduzione.spremiture.seconda.quantita;
               if (datiProduzione.spremiture.torchiato.quantita) quantitaTotaleSucco += datiProduzione.spremiture.torchiato.quantita;
               if (datiProduzione.spremiture.estratto.quantita) quantitaTotaleSucco += datiProduzione.spremiture.estratto.quantita;
               
               // Incremento contatori
               lottiCount++;
               succoTotale += quantitaTotaleSucco;
               olioTotale += datiProduzione.quantita * 0.01; // Simulazione 1% di olio essenziale
               
               // Aggiornamento statistiche
               updateStats();
               
               // Reset form
               $("#produzione-form")[0].reset();
               $("[id^='opzioni-']").hide();
               $("[id$='-container']").hide();
               
               console.log("Dati produzione:", datiProduzione);
               alert("Dati di produzione salvati con successo!\nID Lotto: " + lottoId);
           });
           
           // Aggiornamento statistiche
           function updateStats() {
               $("#total-lotti").text(lottiCount);
               $("#total-succo").text(succoTotale + " L");
               $("#total-olio").text(olioTotale.toFixed(2) + " L");
               $("#lotti-registrati").text(lottiRegistrati);
           }
           
           // Utility per padding zeri
           function padZero(num) {
               return num < 10 ? "0" + num : num;
           }
           
           // Precompilazione orario corrente
           const now = new Date();
           const currentTime = padZero(now.getHours()) + ":" + padZero(now.getMinutes());
           $("#orario-partenza-effettivo").val(currentTime);
       });
   </script>
</body>
</html>
