<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Gestione Produzione Agrumi - Reparto 2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        .header {
            background-color: #D4A017; /* Giallo ocra */
            color: white;
            padding: 15px 0;
            margin-bottom: 30px;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            background-color: #f5efd4;
            font-weight: bold;
        }
        .btn-custom {
            background-color: #D4A017;
            color: white;
        }
        .btn-custom:hover {
            background-color: #b08612;
            color: white;
        }
        .required-field::after {
            content: " *";
            color: red;
        }
        .btn-registro {
            background-color: #0056b3;
            color: white;
            font-weight: bold;
        }
        .btn-registro:hover {
            background-color: #004494;
            color: white;
        }
        .info-box {
            background-color: #f8f9fa;
            border-left: 4px solid #D4A017;
            padding: 10px;
            margin-bottom: 10px;
        }
        .info-box-title {
            font-weight: bold;
            color: #D4A017;
        }
        .section-heading {
            background-color: #f5efd4;
            padding: 8px 15px;
            border-radius: 5px;
            margin-top: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #D4A017;
        }
        .highlighted-info {
            background-color: #f5efd4;
            border: 2px solid #D4A017;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
        }
        .highlighted-field {
            font-weight: bold;
            background-color: #fff8e1;
            border: 1px solid #D4A017;
            padding: 8px;
            border-radius: 5px;
        }
        .main-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #D4A017;
            text-align: center;
            margin: 15px 0;
            border-bottom: 2px solid #D4A017;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-2 text-start">
                    <button class="btn btn-light" id="btn-reparto-1">
                        <i class="bi bi-arrow-left-circle"></i> Reparto 1
                    </button>
                </div>
                <div class="col-md-8 text-center">
                    <h1>SIMONE GATTO PROD-REPARTO 2- TRASFORMAZIONE</h1>
                </div>
                <div class="col-md-2 text-end">
                    <button class="btn btn-light" id="btn-reparto-3">
                        Reparto 3 <i class="bi bi-arrow-right-circle"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mb-5">
        <!-- Informazioni principali evidenziate -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="main-title">
                    <div class="row align-items-center">
                        <div class="col-md-4">
                            <select class="form-select form-select-lg highlighted-field" id="tipo-agrume" required>
                                <option value="" selected disabled>Seleziona Agrume...</option>
                                <option value="Arance">ARANCE</option>
                                <option value="Arance Rosse">ARANCE ROSSE</option>
                                <option value="Limoni">LIMONI</option>
                                <option value="Mandarini">MANDARINI</option>
                                <option value="Pompelmi">POMPELMI</option>
                                <option value="Altro">ALTRO</option>
                            </select>
                            <div id="altro-agrume-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control highlighted-field" id="altro-agrume" placeholder="Specifica altro agrume">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <span id="titolo-data">DEL <input type="date" class="form-control highlighted-field" id="data-lavorazione" required></span>
                        </div>
                        <div class="col-md-4">
                            <div id="info-lotto" class="highlighted-field"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Form inserimento dati -->
        <div class="card mb-4">
            <div class="card-header">
                <i class="bi bi-pencil-square"></i> Inserimento Dati di Lavorazione
            </div>
            <div class="card-body">
                <form id="produzione-form">
                    <h5 class="section-heading">Dettagli Lavorazione</h5>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="linea-trasformazione" class="form-label required-field">Linea di Trasformazione</label>
                            <select class="form-select highlighted-field" id="linea-trasformazione" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="BOE">BOE</option>
                                <option value="GOE INT">GOE INT</option>
                                <option value="B/SF">B/SF</option>
                                <option value="400">400</option>
                                <option value="ALTRA">ALTRA</option>
                            </select>
                            <div id="altra-linea-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control highlighted-field" id="altra-linea" placeholder="Specifica altra linea">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="fornitore" class="form-label required-field">Fornitore</label>
                            <select class="form-select highlighted-field" id="fornitore" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="ARCO">ARCO</option>
                                <option value="CI">CI</option>
                                <option value="RESTUCCIA">RESTUCCIA</option>
                                <option value="ALTRO">ALTRO</option>
                            </select>
                            <div id="altro-fornitore-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control highlighted-field" id="altro-fornitore" placeholder="Specifica altro fornitore">
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="destinazione-essenza" class="form-label required-field">Destinazione Essenza</label>
                            <select class="form-select" id="destinazione-essenza" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="Bio">Bio</option>
                                <option value="Convenzionale">Convenzionale</option>
                                <option value="Non Trattato">Non Trattato</option>
                                <option value="Altra">Altra</option>
                            </select>
                            <div id="altra-essenza-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altra-essenza" placeholder="Specifica altra destinazione">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="certificazione" class="form-label required-field">Certificazione</label>
                            <select class="form-select" id="certificazione" required>
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="BIO EU">BIO EU</option>
                                <option value="BIO DEMETER">BIO DEMETER</option>
                                <option value="CONVENZIONALE">CONVENZIONALE</option>
                                <option value="IGP">IGP</option>
                                <option value="ALTRO">ALTRO</option>
                            </select>
                            <div id="altra-certificazione-container" style="display: none;" class="mt-2">
                                <input type="text" class="form-control" id="altra-certificazione" placeholder="Specifica altra certificazione">
                            </div>
                        </div>
                    </div>

                    <!-- Nuova sezione per orari e quantità -->
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <label for="orario-partenza-stimato" class="form-label">Orario Partenza Stimato</label>
                            <input type="time" class="form-control" id="orario-partenza-stimato">
                        </div>
                        <div class="col-md-3">
                            <label for="orario-partenza-effettivo" class="form-label">Orario Partenza Effettivo</label>
                            <input type="time" class="form-control" id="orario-partenza-effettivo">
                            <small class="text-muted">Rilevato da Rep. 1</small>
                        </div>
                        <div class="col-md-3">
                            <label for="orario-fine-stimato" class="form-label">Orario Fine Stimato</label>
                            <input type="time" class="form-control" id="orario-fine-stimato">
                        </div>
                        <div class="col-md-3">
                            <label for="orario-fine-effettivo" class="form-label">Orario Fine Effettivo</label>
                            <input type="time" class="form-control" id="orario-fine-effettivo">
                            <small class="text-muted">Rilevato da Rep. 1</small>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="quantita-frutta-stimata" class="form-label">Quantità Frutta Stimata (kg)</label>
                            <input type="number" class="form-control" id="quantita-frutta-stimata" min="0">
                        </div>
                        <div class="col-md-6">
                            <label for="quantita-frutta-effettiva" class="form-label">Quantità Frutta Effettiva (kg)</label>
                            <input type="number" class="form-control" id="quantita-frutta-effettiva" min="0">
                            <small class="text-muted">Rilevato da Rep. 1 - Totale frutta nei silos per lotti</small>
                        </div>
                    </div>

                    <h5 class="section-heading">Destinazione Spremiture</h5>
                    
                    <div class="row mb-4">
                        <!-- 1ª Spremitura -->
                        <div class="col-md-3">
                            <label for="prima-spremitura" class="form-label">1ª Spremitura</label>
                            <select class="form-select spremitura-select" id="prima-spremitura">
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="CISTERNA PL">CISTERNA PL</option>
                                <option value="CISTERNA VK">CISTERNA VK</option>
                                <option value="CISTERNA EF">CISTERNA EF</option>
                                <option value="NAT IN TINI CONSERVATO">NAT IN TINI CONSERVATO</option>
                                <option value="F.F.">F.F.</option>
                                <option value="F.T.C.">F.T.C.</option>
                                <option value="LATTE 20 KG">LATTE 20 KG</option>
                                <option value="VASCHETTE">VASCHETTE</option>
                                <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                <option value="REX">REX</option>
                                <option value="ACMA">ACMA</option>
                                <option value="GOGLIO 3 KG">GOGLIO 3 KG</option>
                                <option value="PET 100">PET 100</option>
                                <option value="PET 200">PET 200</option>
                                <option value="PET 480">PET 480</option>
                                <option value="CONCENTRATO">CONCENTRATO</option>
                                <option value="ALTRO">ALTRO</option>
                                <option value="Nessuna">Nessuna</option>
                            </select>
                            
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <label for="quantita-stimata-prima" class="form-label">Quantità Stimata (L)</label>
                                    <input type="number" class="form-control" id="quantita-stimata-prima" min="0">
                                </div>
                                <div class="col-md-6">
                                    <label for="quantita-effettiva-prima" class="form-label">Quantità Effettiva (L)</label>
                                    <input type="number" class="form-control" id="quantita-prima" min="0">
                                </div>
                            </div>
                            
                            <div id="opzioni-aggiuntive-prima" class="mt-2">
                                <label for="grado-bx-prima" class="form-label">Grado °BX</label>
                                <select class="form-select" id="grado-bx-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="NAT">NAT</option>
                                    <option value="20°">20°</option>
                                    <option value="32°">32°</option>
                                    <option value="40°">40°</option>
                                    <option value="45°">45°</option>
                                    <option value="55°">55°</option>
                                    <option value="58°">58°</option>
                                    <option value="60°">60°</option>
                                    <option value="63.5°">63.5°</option>
                                    <option value="65°">65°</option>
                                </select>
                                
                                <label for="tenore-polpa-prima" class="form-label mt-2">Tenore di Polpa</label>
                                <select class="form-select" id="tenore-polpa-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="LIMPIDO">LIMPIDO</option>
                                    <option value="SEMICLEAR">SEMICLEAR</option>
                                    <option value="1%">1%</option>
                                    <option value="2%">2%</option>
                                    <option value="3%">3%</option>
                                    <option value="5%">5%</option>
                                    <option value="STANDARD">STANDARD</option>
                                </select>
                                
                                <label for="pastorizzazione-prima" class="form-label mt-2">Pastorizzazione</label>
                                <select class="form-select" id="pastorizzazione-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="SI">SI</option>
                                    <option value="NO">NO</option>
                                </select>
                                
                                <label for="stoccaggio-prima" class="form-label mt-2">Stoccaggio/Confezionamento</label>
                                <select class="form-select" id="stoccaggio-prima">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="PET 100">PET 100</option>
                                    <option value="PET 200">PET 200</option>
                                    <option value="PET 480">PET 480</option>
                                    <option value="REX">REX</option>
                                    <option value="ACMA">ACMA</option>
                                    <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                    <option value="VASCHETTE">VASCHETTE</option>
                                    <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                    <option value="LATTE">LATTE</option>
                                    <option value="FBL">FBL</option>
                                    <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                    <option value="FUSTI T.C">FUSTI T.C</option>
                                    <option value="BIC">BIC</option>
                                    <option value="1 Azz.">1 Azz.</option>
                                    <option value="2 Azz.">2 Azz.</option>
                                    <option value="3 Azz.">3 Azz.</option>
                                    <option value="4 Azz.">4 Azz.</option>
                                    <option value="5 Azz.">5 Azz.</option>
                                    <option value="6 Azz.">6 Azz.</option>
                                    <option value="7 Azz.">7 Azz.</option>
                                    <option value="8 Azz.">8 Azz.</option>
                                    <option value="9 Azz.">9 Azz.</option>
                                    <option value="10 Azz.">10 Azz.</option>
                                    <option value="1 Est.">1 Est.</option>
                                    <option value="2 Est.">2 Est.</option>
                                    <option value="3 Est.">3 Est.</option>
                                    <option value="4 Est.">4 Est.</option>
                                    <option value="5 Est.">5 Est.</option>
                                    <option value="6 Est.">6 Est.</option>
                                    <option value="7 Est.">7 Est.</option>
                                    <option value="8 Est.">8 Est.</option>
                                    <option value="9 Est.">9 Est.</option>
                                    <option value="10 Est.">10 Est.</option>
                                    <option value="11 Est.">11 Est.</option>
                                    <option value="12 Est.">12 Est.</option>
                                    <option value="13 Est.">13 Est.</option>
                                    <option value="14 Est.">14 Est.</option>
                                    <option value="15 Est.">15 Est.</option>
                                    <option value="16 Est.">16 Est.</option>
                                    <option value="17 Est.">17 Est.</option>
                                    <option value="18 Est.">18 Est.</option>
                                    <option value="71 Est.">71 Est.</option>
                                    <option value="72 Est.">72 Est.</option>
                                    <option value="73 Est.">73 Est.</option>
                                    <option value="74 Est.">74 Est.</option>
                                    <option value="75 Est.">75 Est.</option>
                                    <option value="76 Est.">76 Est.</option>
                                    <option value="77 Est.">77 Est.</option>
                                    <option value="78 Est.">78 Est.</option>
                                    <option value="79 Est.">79 Est.</option>
                                    <option value="80 Est.">80 Est.</option>
                                    <option value="81 Est.">81 Est.</option>
                                </select>
                            </div>
                            
                            <div class="mt-2">
                                <label for="note-prima" class="form-label">Note</label>
                                <textarea class="form-control" id="note-prima" rows="2"></textarea>
                            </div>
                        </div>
                        
                        <!-- 2ª Spremitura -->
                        <div class="col-md-3">
                            <label for="seconda-spremitura" class="form-label">2ª Spremitura</label>
                            <select class="form-select spremitura-select" id="seconda-spremitura">
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="CISTERNA PL">CISTERNA PL</option>
                                <option value="CISTERNA VK">CISTERNA VK</option>
                                <option value="CISTERNA EF">CISTERNA EF</option>
                                <option value="NAT IN TINI CONSERVATO">NAT IN TINI CONSERVATO</option>
                                <option value="F.F.">F.F.</option>
                                <option value="F.T.C.">F.T.C.</option>
                                <option value="LATTE 20 KG">LATTE 20 KG</option>
                                <option value="VASCHETTE">VASCHETTE</option>
                                <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                <option value="REX">REX</option>
                                <option value="ACMA">ACMA</option>
                                <option value="GOGLIO 3 KG">GOGLIO 3 KG</option>
                                <option value="PET 100">PET 100</option>
                                <option value="PET 200">PET 200</option>
                                <option value="PET 480">PET 480</option>
                                <option value="CONCENTRATO">CONCENTRATO</option>
                                <option value="ALTRO">ALTRO</option>
                                <option value="Nessuna">Nessuna</option>
                            </select>
                            
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <label for="quantita-stimata-seconda" class="form-label">Quantità Stimata (L)</label>
                                    <input type="number" class="form-control" id="quantita-stimata-seconda" min="0">
                                </div>
                                <div class="col-md-6">
                                    <label for="quantita-effettiva-seconda" class="form-label">Quantità Effettiva (L)</label>
                                    <input type="number" class="form-control" id="quantita-seconda" min="0">
                                </div>
                            </div>
                            
                            <div id="opzioni-aggiuntive-seconda" class="mt-2">
                                <label for="grado-bx-seconda" class="form-label">Grado °BX</label>
                                <select class="form-select" id="grado-bx-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="NAT">NAT</option>
                                    <option value="20°">20°</option>
                                    <option value="32°">32°</option>
                                    <option value="40°">40°</option>
                                    <option value="45°">45°</option>
                                    <option value="55°">55°</option>
                                    <option value="58°">58°</option>
                                    <option value="60°">60°</option>
                                    <option value="63.5°">63.5°</option>
                                    <option value="65°">65°</option>
                                </select>
                                
                                <label for="tenore-polpa-seconda" class="form-label mt-2">Tenore di Polpa</label>
                                <select class="form-select" id="tenore-polpa-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="LIMPIDO">LIMPIDO</option>
                                    <option value="SEMICLEAR">SEMICLEAR</option>
                                    <option value="1%">1%</option>
                                    <option value="2%">2%</option>
                                    <option value="3%">3%</option>
                                    <option value="5%">5%</option>
                                    <option value="STANDARD">STANDARD</option>
                                </select>
                                
                                <label for="pastorizzazione-seconda" class="form-label mt-2">Pastorizzazione</label>
                                <select class="form-select" id="pastorizzazione-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="SI">SI</option>
                                    <option value="NO">NO</option>
                                </select>
                                
                                <label for="stoccaggio-seconda" class="form-label mt-2">Stoccaggio/Confezionamento</label>
                                <select class="form-select" id="stoccaggio-seconda">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="PET 100">PET 100</option>
                                    <!-- Altre opzioni stoccaggio come nella prima spremitura -->
                                </select>
                            </div>
                            
                            <div class="mt-2">
                                <label for="note-seconda" class="form-label">Note</label>
                                <textarea class="form-control" id="note-seconda" rows="2"></textarea>
                            </div>
                        </div>
                        
                        <!-- Torchiato -->
                        <div class="col-md-3">
                            <label for="torchiato" class="form-label">Torchiato</label>
                            <select class="form-select spremitura-select" id="torchiato">
                                <option value="" selected disabled>Seleziona...</option>
                                <option value="CISTERNA PL">CISTERNA PL</option>
                                <option value="CISTERNA VK">CISTERNA VK</option>
                                <option value="CISTERNA EF">CISTERNA EF</option>
                                <option value="NAT IN TINI CONSERVATO">NAT IN TINI CONSERVATO</option>
                                <option value="F.F.">F.F.</option>
                                <option value="F.T.C.">F.T.C.</option>
                                <option value="LATTE 20 KG">LATTE 20 KG</option>
                                <option value="VASCHETTE">VASCHETTE</option>
                                <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                <option value="REX">REX</option>
                                <option value="ACMA">ACMA</option>
                                <option value="GOGLIO 3 KG">GOGLIO 3 KG</option>
                                <option value="PET 100">PET 100</option>
                                <option value="PET 200">PET 200</option>
                                <option value="PET 480">PET 480</option>
                                <option value="CONCENTRATO">CONCENTRATO</option>
                                <option value="ALTRO">ALTRO</option>
                                <option value="Nessuna">Nessuna</option>
                            </select>
                            
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <label for="quantita-stimata-torchiato" class="form-label">Quantità Stimata (L)</label>
                                    <input type="number" class="form-control" id="quantita-stimata-torchiato" min="0">
                                </div>
                                <div class="col-md-6">
                                    <label for="quantita-effettiva-torchiato" class="form-label">Quantità Effettiva (L)</label>
                                    <input type="number" class="form-control" id="quantita-torchiato" min="0">
                                </div>
                            </div>
                            
                            <div id="opzioni-aggiuntive-torchiato" class="mt-2">
                                <label for="grado-bx-torchiato" class="form-label">Grado °BX</label>
                                <select class="form-select" id="grado-bx-torchiato">
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="NAT">NAT</option>
                                    <option value="20°">20°</option>
                                    <option value="32°">32°</option>
                                    <option value="40°">40°</option>
                                    <option value="45°">45°</option>
                                    <option value="55°">55°</option>
                                    <option value="58°">58°</option>
                                    <option value="60°">60°</option>
                                    <option value="63.5°">63.5°</option>
                                    <option value="65°">65°</option>
                                </select>
                                
                                <label for="tenore-polpa-torchiato" class="form-label mt-2">Tenore di Polpa</label>
                                <select class="form-select" id="tenore-polpa-torchiato
                                    <select class="form-select" id="tenore-polpa-torchiato">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="LIMPIDO">LIMPIDO</option>
                                   <option value="SEMICLEAR">SEMICLEAR</option>
                                   <option value="1%">1%</option>
                                   <option value="2%">2%</option>
                                   <option value="3%">3%</option>
                                   <option value="5%">5%</option>
                                   <option value="STANDARD">STANDARD</option>
                               </select>
                               
                               <label for="pastorizzazione-torchiato" class="form-label mt-2">Pastorizzazione</label>
                               <select class="form-select" id="pastorizzazione-torchiato">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="SI">SI</option>
                                   <option value="NO">NO</option>
                               </select>
                               
                               <label for="stoccaggio-torchiato" class="form-label mt-2">Stoccaggio/Confezionamento</label>
                               <select class="form-select" id="stoccaggio-torchiato">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="PET 100">PET 100</option>
                                   <option value="PET 200">PET 200</option>
                                   <option value="PET 480">PET 480</option>
                                   <option value="REX">REX</option>
                                   <option value="ACMA">ACMA</option>
                                   <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                   <option value="VASCHETTE">VASCHETTE</option>
                                   <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                   <option value="LATTE">LATTE</option>
                                   <option value="FBL">FBL</option>
                                   <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                   <option value="FUSTI T.C">FUSTI T.C</option>
                                   <option value="BIC">BIC</option>
                                   <option value="1 Azz.">1 Azz.</option>
                                   <option value="2 Azz.">2 Azz.</option>
                                   <option value="3 Azz.">3 Azz.</option>
                                   <option value="4 Azz.">4 Azz.</option>
                                   <option value="5 Azz.">5 Azz.</option>
                                   <option value="6 Azz.">6 Azz.</option>
                                   <option value="7 Azz.">7 Azz.</option>
                                   <option value="8 Azz.">8 Azz.</option>
                                   <option value="9 Azz.">9 Azz.</option>
                                   <option value="10 Azz.">10 Azz.</option>
                                   <option value="1 Est.">1 Est.</option>
                                   <option value="2 Est.">2 Est.</option>
                                   <option value="3 Est.">3 Est.</option>
                                   <option value="4 Est.">4 Est.</option>
                                   <option value="5 Est.">5 Est.</option>
                                   <option value="6 Est.">6 Est.</option>
                                   <option value="7 Est.">7 Est.</option>
                                   <option value="8 Est.">8 Est.</option>
                                   <option value="9 Est.">9 Est.</option>
                                   <option value="10 Est.">10 Est.</option>
                                   <option value="11 Est.">11 Est.</option>
                                   <option value="12 Est.">12 Est.</option>
                                   <option value="13 Est.">13 Est.</option>
                                   <option value="14 Est.">14 Est.</option>
                                   <option value="15 Est.">15 Est.</option>
                                   <option value="16 Est.">16 Est.</option>
                                   <option value="17 Est.">17 Est.</option>
                                   <option value="18 Est.">18 Est.</option>
                                   <option value="71 Est.">71 Est.</option>
                                   <option value="72 Est.">72 Est.</option>
                                   <option value="73 Est.">73 Est.</option>
                                   <option value="74 Est.">74 Est.</option>
                                   <option value="75 Est.">75 Est.</option>
                                   <option value="76 Est.">76 Est.</option>
                                   <option value="77 Est.">77 Est.</option>
                                   <option value="78 Est.">78 Est.</option>
                                   <option value="79 Est.">79 Est.</option>
                                   <option value="80 Est.">80 Est.</option>
                                   <option value="81 Est.">81 Est.</option>
                               </select>
                           </div>
                           
                           <div class="mt-2">
                               <label for="note-torchiato" class="form-label">Note</label>
                               <textarea class="form-control" id="note-torchiato" rows="2"></textarea>
                           </div>
                       </div>
                       
                       <!-- Estratto -->
                       <div class="col-md-3">
                           <label for="estratto" class="form-label">Estratto</label>
                           <select class="form-select spremitura-select" id="estratto">
                               <option value="" selected disabled>Seleziona...</option>
                               <option value="CISTERNA PL">CISTERNA PL</option>
                               <option value="CISTERNA VK">CISTERNA VK</option>
                               <option value="CISTERNA EF">CISTERNA EF</option>
                               <option value="NAT IN TINI CONSERVATO">NAT IN TINI CONSERVATO</option>
                               <option value="F.F.">F.F.</option>
                               <option value="F.T.C.">F.T.C.</option>
                               <option value="LATTE 20 KG">LATTE 20 KG</option>
                               <option value="VASCHETTE">VASCHETTE</option>
                               <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                               <option value="REX">REX</option>
                               <option value="ACMA">ACMA</option>
                               <option value="GOGLIO 3 KG">GOGLIO 3 KG</option>
                               <option value="PET 100">PET 100</option>
                               <option value="PET 200">PET 200</option>
                               <option value="PET 480">PET 480</option>
                               <option value="CONCENTRATO">CONCENTRATO</option>
                               <option value="ALTRO">ALTRO</option>
                               <option value="Nessuna">Nessuna</option>
                           </select>
                           
                           <div class="row mt-2">
                               <div class="col-md-6">
                                   <label for="quantita-stimata-estratto" class="form-label">Quantità Stimata (L)</label>
                                   <input type="number" class="form-control" id="quantita-stimata-estratto" min="0">
                               </div>
                               <div class="col-md-6">
                                   <label for="quantita-effettiva-estratto" class="form-label">Quantità Effettiva (L)</label>
                                   <input type="number" class="form-control" id="quantita-estratto" min="0">
                               </div>
                           </div>
                           
                           <div id="opzioni-aggiuntive-estratto" class="mt-2">
                               <label for="grado-bx-estratto" class="form-label">Grado °BX</label>
                               <select class="form-select" id="grado-bx-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="NAT">NAT</option>
                                   <option value="20°">20°</option>
                                   <option value="32°">32°</option>
                                   <option value="40°">40°</option>
                                   <option value="45°">45°</option>
                                   <option value="55°">55°</option>
                                   <option value="58°">58°</option>
                                   <option value="60°">60°</option>
                                   <option value="63.5°">63.5°</option>
                                   <option value="65°">65°</option>
                               </select>
                               
                               <label for="tenore-polpa-estratto" class="form-label mt-2">Tenore di Polpa</label>
                               <select class="form-select" id="tenore-polpa-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="LIMPIDO">LIMPIDO</option>
                                   <option value="SEMICLEAR">SEMICLEAR</option>
                                   <option value="1%">1%</option>
                                   <option value="2%">2%</option>
                                   <option value="3%">3%</option>
                                   <option value="5%">5%</option>
                                   <option value="STANDARD">STANDARD</option>
                               </select>
                               
                               <label for="pastorizzazione-estratto" class="form-label mt-2">Pastorizzazione</label>
                               <select class="form-select" id="pastorizzazione-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="SI">SI</option>
                                   <option value="NO">NO</option>
                               </select>
                               
                               <label for="stoccaggio-estratto" class="form-label mt-2">Stoccaggio/Confezionamento</label>
                               <select class="form-select" id="stoccaggio-estratto">
                                   <option value="" selected disabled>Seleziona...</option>
                                   <option value="PET 100">PET 100</option>
                                   <option value="PET 200">PET 200</option>
                                   <option value="PET 480">PET 480</option>
                                   <option value="REX">REX</option>
                                   <option value="ACMA">ACMA</option>
                                   <option value="BUSTE GOGLIO">BUSTE GOGLIO</option>
                                   <option value="VASCHETTE">VASCHETTE</option>
                                   <option value="VASCHETTE ZUCCHERATE">VASCHETTE ZUCCHERATE</option>
                                   <option value="LATTE">LATTE</option>
                                   <option value="FBL">FBL</option>
                                   <option value="FUSTI DI FERRO">FUSTI DI FERRO</option>
                                   <option value="FUSTI T.C">FUSTI T.C</option>
                                   <option value="BIC">BIC</option>
                                   <option value="1 Azz.">1 Azz.</option>
                                   <option value="2 Azz.">2 Azz.</option>
                                   <option value="3 Azz.">3 Azz.</option>
                                   <option value="4 Azz.">4 Azz.</option>
                                   <option value="5 Azz.">5 Azz.</option>
                                   <option value="6 Azz.">6 Azz.</option>
                                   <option value="7 Azz.">7 Azz.</option>
                                   <option value="8 Azz.">8 Azz.</option>
                                   <option value="9 Azz.">9 Azz.</option>
                                   <option value="10 Azz.">10 Azz.</option>
                                   <option value="1 Est.">1 Est.</option>
                                   <option value="2 Est.">2 Est.</option>
                                   <option value="3 Est.">3 Est.</option>
                                   <option value="4 Est.">4 Est.</option>
                                   <option value="5 Est.">5 Est.</option>
                                   <option value="6 Est.">6 Est.</option>
                                   <option value="7 Est.">7 Est.</option>
                                   <option value="8 Est.">8 Est.</option>
                                   <option value="9 Est.">9 Est.</option>
                                   <option value="10 Est.">10 Est.</option>
                                   <option value="11 Est.">11 Est.</option>
                                   <option value="12 Est.">12 Est.</option>
                                   <option value="13 Est.">13 Est.</option>
                                   <option value="14 Est.">14 Est.</option>
                                   <option value="15 Est.">15 Est.</option>
                                   <option value="16 Est.">16 Est.</option>
                                   <option value="17 Est.">17 Est.</option>
                                   <option value="18 Est.">18 Est.</option>
                                   <option value="71 Est.">71 Est.</option>
                                   <option value="72 Est.">72 Est.</option>
                                   <option value="73 Est.">73 Est.</option>
                                   <option value="74 Est.">74 Est.</option>
                                   <option value="75 Est.">75 Est.</option>
                                   <option value="76 Est.">76 Est.</option>
                                   <option value="77 Est.">77 Est.</option>
                                   <option value="78 Est.">78 Est.</option>
                                   <option value="79 Est.">79 Est.</option>
                                   <option value="80 Est.">80 Est.</option>
                                   <option value="81 Est.">81 Est.</option>
                               </select>
                           </div>
                           
                           <div class="mt-2">
                               <label for="note-estratto" class="form-label">Note</label>
                               <textarea class="form-control" id="note-estratto" rows="2"></textarea>
                           </div>
                       </div>
                   </div>

                   <div class="text-end mt-4">
                       <button type="button" class="btn btn-secondary me-2" id="btn-reset">
                           <i class="bi bi-x-circle"></i> Annulla
                       </button>
                       <button type="submit" class="btn btn-custom me-2">
                           <i class="bi bi-save"></i> Salva Dati
                       </button>
                       <button type="button" class="btn btn-registro" id="btn-registro-elettronico">
                           <i class="bi bi-journal-check"></i> Registra su Bolletta Elettronica
                       </button>
                   </div>
               </form>
           </div>
       </div>
   </div>

   <!-- Script JS -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
   <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
   <script>
       $(document).ready(function() {
           // Inizializza ID lotto
           let lottoId = "";
           
           // Aggiorna il titolo della pagina quando cambia il tipo di agrume
           $("#tipo-agrume").change(function() {
               updatePageTitle();
               
               if ($(this).val() === "Altro") {
                   $("#altro-agrume-container").show();
                   $("#altro-agrume").on('input', function() {
                       updatePageTitle();
                   });
               } else {
                   $("#altro-agrume-container").hide();
                   $("#altro-agrume").val("");
               }
           });
           
           // Aggiorna il titolo quando cambia la data
           $("#data-lavorazione").change(function() {
               updatePageTitle();
           });
           
           // Funzione per aggiornare il titolo della pagina
           function updatePageTitle() {
               let tipoAgrume = $("#tipo-agrume").val();
               if (tipoAgrume === "Altro") {
                   tipoAgrume = $("#altro-agrume").val();
               }
               
               let dataLavorazione = $("#data-lavorazione").val();
               let dataFormattata = "";
               
               if (dataLavorazione) {
                   const date = new Date(dataLavorazione);
                   dataFormattata = date.toLocaleDateString('it-IT', {
                       day: '2-digit',
                       month: '2-digit',
                       year: 'numeric'
                   });
               }
               
               if (tipoAgrume && dataFormattata) {
                   $("#titolo-data").html("DEL " + dataFormattata);
                   // Formatta e mostra il titolo principale evidenziato
                   $(".main-title").addClass("highlight-animation");
                   setTimeout(function() {
                       $(".main-title").removeClass("highlight-animation");
                   }, 1000);
               }
           }
           
           // Inizializza stato dei campi opzioni aggiuntive (nascosti all'inizio)
           $("#opzioni-aggiuntive-prima").hide();
           $("#opzioni-aggiuntive-seconda").hide();
           $("#opzioni-aggiuntive-torchiato").hide();
           $("#opzioni-aggiuntive-estratto").hide();
           
           // Gestione altra linea di trasformazione
           $("#linea-trasformazione").change(function() {
               if ($(this).val() === "ALTRA") {
                   $("#altra-linea-container").show();
               } else {
                   $("#altra-linea-container").hide();
                   $("#altra-linea").val("");
               }
           });
           
           // Gestione altro fornitore
           $("#fornitore").change(function() {
               if ($(this).val() === "ALTRO") {
                   $("#altro-fornitore-container").show();
               } else {
                   $("#altro-fornitore-container").hide();
                   $("#altro-fornitore").val("");
               }
           });
           
           // Gestione altra destinazione essenza
           $("#destinazione-essenza").change(function() {
               if ($(this).val() === "Altra") {
                   $("#altra-essenza-container").show();
               } else {
                   $("#altra-essenza-container").hide();
                   $("#altra-essenza").val("");
               }
           });
           
           // Gestione altra certificazione
           $("#certificazione").change(function() {
               if ($(this).val() === "ALTRO") {
                   $("#altra-certificazione-container").show();
               } else {
                   $("#altra-certificazione-container").hide();
                   $("#altra-certificazione").val("");
               }
           });
           
           // NUOVA LOGICA: Gestione opzioni aggiuntive per tutte le spremiture
           // Prima spremitura - mostra opzioni aggiuntive per qualsiasi selezione tranne "Nessuna"
           $("#prima-spremitura").change(function() {
               if ($(this).val() && $(this).val() !== "Nessuna") {
                   $("#opzioni-aggiuntive-prima").slideDown();
               } else {
                   $("#opzioni-aggiuntive-prima").slideUp();
                   $("#grado-bx-prima").val("");
                   $("#tenore-polpa-prima").val("");
                   $("#pastorizzazione-prima").val("");
                   $("#stoccaggio-prima").val("");
               }
           });
           
           // Seconda spremitura
           $("#seconda-spremitura").change(function() {
               if ($(this).val() && $(this).val() !== "Nessuna") {
                   $("#opzioni-aggiuntive-seconda").slideDown();
               } else {
                   $("#opzioni-aggiuntive-seconda").slideUp();
                   $("#grado-bx-seconda").val("");
                   $("#tenore-polpa-seconda").val("");
                   $("#pastorizzazione-seconda").val("");
                   $("#stoccaggio-seconda").val("");
               }
           });
           
           // Torchiato
           $("#torchiato").change(function() {
               if ($(this).val() && $(this).val() !== "Nessuna") {
                   $("#opzioni-aggiuntive-torchiato").slideDown();
               } else {
                   $("#opzioni-aggiuntive-torchiato").slideUp();
                   $("#grado-bx-torchiato").val("");
                   $("#tenore-polpa-torchiato").val("");
                   $("#pastorizzazione-torchiato").val("");
                   $("#stoccaggio-torchiato").val("");
               }
           });
           
           // Estratto
           $("#estratto").change(function() {
               if ($(this).val() && $(this).val() !== "Nessuna") {
                   $("#opzioni-aggiuntive-estratto").slideDown();
               } else {
                   $("#opzioni-aggiuntive-estratto").slideUp();
                   $("#grado-bx-estratto").val("");
                   $("#tenore-polpa-estratto").val("");
                   $("#pastorizzazione-estratto").val("");
                   $("#stoccaggio-estratto").val("");
               }
           });
           
           // Pulsante reset form
           $("#btn-reset").click(function() {
               if (confirm("Vuoi davvero annullare? I dati inseriti andranno persi.")) {
                   $("#produzione-form")[0].reset();
                   $("#opzioni-aggiuntive-prima").hide();
                   $("#opzioni-aggiuntive-seconda").hide();
                   $("#opzioni-aggiuntive-torchiato").hide();
                   $("#opzioni-aggiuntive-estratto").hide();
                   $("[id$='-container']").hide();
                   $("#info-lotto").text("");
               }
           });
           
           // Pulsanti navigazione reparti
           $("#btn-reparto-1").click(function() {
               if (confirm("Passare al Reparto 1? Le modifiche non salvate andranno perse.")) {
                   alert("Collegamento al Reparto 1 simulato.");
               }
           });
           
           $("#btn-reparto-3").click(function() {
               if (confirm("Passare al Reparto 3? Le modifiche non salvate andranno perse.")) {
                   alert("Collegamento al Reparto 3 simulato.");
               }
           });
           
           // Pulsante registro elettronico
           $("#btn-registro-elettronico").click(function() {
               if (!lottoId) {
                   alert("Non ci sono dati da registrare nella bolletta elettronica. Salva prima i dati di produzione.");
                   return;
               }
               
               // Simulazione registrazione
               let numeroRegistrazione = "REG-" + new Date().getTime().toString().substr(-6);
               
               alert("Registrazione su bolletta elettronica completata con successo!\nNumero registrazione: " + numeroRegistrazione);
           });
           
           // Salvataggio dati produzione
           $("#produzione-form").submit(function(e) {
               e.preventDefault();
               
               // Verifica campi obbligatori nella sezione principale
               if (!$("#tipo-agrume").val() || !$("#data-lavorazione").val() || 
                   !$("#linea-trasformazione").val() || !$("#fornitore").val() || 
                   !$("#destinazione-essenza").val() || !$("#certificazione").val()) {
                   alert("Compila tutti i campi obbligatori nella sezione dettagli lavorazione!");
                   return;
               }
               
               // Raccolta dati
               let tipoAgrume = $("#tipo-agrume").val();
               if (tipoAgrume === "Altro") {
                   tipoAgrume = $("#altro-agrume").val();
               }
               
               let dataLavorazione = $("#data-lavorazione").val();
               
               let lineaTrasformazione = $("#linea-trasformazione").val();
               if (lineaTrasformazione === "ALTRA") {
                   lineaTrasformazione = $("#altra-linea").val();
               }
               
               let fornitore = $("#fornitore").val();
               if (fornitore === "ALTRO") {
                   fornitore = $("#altro-fornitore").val();
               }
               
               let destinazioneEssenza = $("#destinazione-essenza").val();
               if (destinazioneEssenza === "Altra") {
                   destinazioneEssenza = $("#altra-essenza").val();
               }
               
               let certificazione = $("#certificazione").val();
               if (certificazione === "ALTRO") {
                   certificazione = $("#altra-certificazione").val();
               }
               
               // Orari e quantità
               let orariEQuantita = {
                   orarioPartenzaStimato: $("#orario-partenza-stimato").val(),
                   orarioPartenzaEffettivo: $("#orario-partenza-effettivo").val(),
                   orarioFineStimato: $("#orario-fine-stimato").val(),
                   orarioFineEffettivo: $("#orario-fine-effettivo").val(),
                   quantitaFruttaStimata: parseInt($("#quantita-frutta-stimata").val()) || 0,
                   quantitaFruttaEffettiva: parseInt($("#quantita-frutta-effettiva").val()) || 0
               };
               
               // Dati spremiture
               let spremiture = {
                   prima: {
                       destinazione: $("#prima-spremitura").val(),
                       quantitaStimata: parseInt($("#quantita-stimata-prima").val()) || 0,
                       quantitaEffettiva: parseInt($("#quantita-prima").val()) || 0,
                       gradoBx: $("#grado-bx-prima").val(),
                       tenorePolpa: $("#tenore-polpa-prima").val(),
                       pastorizzazione: $("#pastorizzazione-prima").val(),
                       stoccaggio: $("#stoccaggio-prima").val(),
                       note: $("#note-prima").val()
                   },
                   seconda: {
                       destinazione: $("#seconda-spremitura").val(),
                       quantitaStimata: parseInt($("#quantita-stimata-seconda").val()) || 0,
                       quantitaEffettiva: parseInt($("#quantita-seconda").val()) || 0,
                       gradoBx: $("#grado-bx-seconda").val(),
                       tenorePolpa: $("#tenore-polpa-seconda").val(),
                       pastorizzazione: $("#pastorizzazione-seconda").val(),
                       stoccaggio: $("#stoccaggio-seconda").val(),
                       note: $("#note-seconda").val()
                   },
                   torchiato: {
                       destinazione: $("#torchiato").val(),
                       quantitaStimata: parseInt($("#quantita-stimata-torchiato").val()) || 0,
                       quantitaEffettiva: parseInt($("#quantita-torchiato").val()) || 0,
                       gradoBx: $("#grado-bx-torchiato").val(),
                       tenorePolpa: $("#tenore-polpa-torchiato").val(),
                       pastorizzazione: $("#pastorizzazione-torchiato").val(),
                       stoccaggio: $("#stoccaggio-torchiato").val(),
                       note: $("#note-torchiato").val()
                   },
                   estratto: {
                       destinazione: $("#estratto").val(),
                       quantitaStimata: parseInt($("#quantita-stimata-estratto").val()) || 0,
                       quantitaEffettiva: parseInt($("#quantita-estratto").val()) || 0,
                       gradoBx: $("#grado-bx-estratto").val(),
                       tenorePolpa: $("#tenore-polpa-estratto").val(),
                       pastorizzazione: $("#pastorizzazione-estratto").val(),
                       stoccaggio: $("#stoccaggio-estratto").val(),
                       note: $("#note-estratto").val()
                   }
               };
               
               // Verifica che almeno una spremitura sia selezionata
               if ((!spremiture.prima.destinazione || spremiture.prima.destinazione === "Nessuna") &&
                   (!spremiture.seconda.destinazione || spremiture.seconda.destinazione === "Nessuna") &&
                   (!spremiture.torchiato.destinazione || spremiture.torchiato.destinazione === "Nessuna") &&
                   (!spremiture.estratto.destinazione || spremiture.estratto.destinazione === "Nessuna")) {
                   alert("Seleziona almeno una destinazione per le spremiture!");
                   return;
               }
               
               // Verifica che le quantità siano specificate per le spremiture selezionate
               if ((spremiture.prima.destinazione && spremiture.prima.destinazione !== "Nessuna" && spremiture.prima.quantitaEffettiva <= 0) ||
                   (spremiture.seconda.destinazione && spremiture.seconda.destinazione !== "Nessuna" && spremiture.seconda.quantitaEffettiva <= 0) ||
                   (spremiture.torchiato.destinazione && spremiture.torchiato.destinazione !== "Nessuna" && spremiture.torchiato.quantitaEffettiva <= 0) ||
                   (spremiture.estratto.destinazione && spremiture.estratto.destinazione !== "Nessuna" && spremiture.estratto.quantitaEffettiva <= 0)) {
                   alert("Inserisci una quantità effettiva valida per ogni spremitura selezionata!");
                   return;
               }
               
               // Verifica che per ogni spremitura selezionata ci siano tutti i dettagli richiesti
               function verificaDettagliSpremitura(spremitura) {
                   if (spremitura.destinazione && spremitura.destinazione !== "Nessuna") {
                       if (!spremitura.gradoBx || !spremitura.tenorePolpa || !spremitura.stoccaggio || !spremitura.pastorizzazione) {
                           return false;
                       }
                   }
                   return true;
               }
               
               if (!verificaDettagliSpremitura(spremiture.prima) || 
                   !verificaDettagliSpremitura(spremiture.seconda) || 
                   !verificaDettagliSpremitura(spremiture.torchiato) || 
                   !verificaDettagliSpremitura(spremiture.
                                               !verificaDettagliSpremitura(spremiture.prima) || 
                   !verificaDettagliSpremitura(spremiture.seconda) || 
                   !verificaDettagliSpremitura(spremiture.torchiato) || 
                   !verificaDettagliSpremitura(spremiture.estratto)) {
                   alert("Per tutte le spremiture selezionate devi specificare: Grado °BX, Tenore di Polpa, Pastorizzazione e Stoccaggio/Confezionamento!");
                   return;
               }
               
               // Simulazione generazione ID lotto
               const now = new Date();
               lottoId = "L-" + 
                       now.getFullYear() + 
                       padZero(now.getMonth() + 1) + 
                       padZero(now.getDate()) + "-" + 
                       padZero(now.getHours()) + 
                       padZero(now.getMinutes());
               
               // Imposta l'ID lotto nell'interfaccia
               $("#info-lotto").text("Lotto: " + lottoId);
               
               alert("Dati di produzione salvati con successo!\nID Lotto: " + lottoId);
           });
           
           // Utility per padding zeri
           function padZero(num) {
               return num < 10 ? "0" + num : num;
           }
           
           // Imposta la data odierna di default
           const today = new Date();
           $("#data-lavorazione").val(today.toISOString().split("T")[0]);
       });
   </script>
</body>
</html>
